<%- include('../mainpage/headerAndNav') %>
<body class='bg'>  
 <div class="container navTopMargin ">
<%- include('userInfoDisplay')%>
     <div class="row d-flex justify-content-center pb-3">
         <div class="col-3 d-flex justify-content-center pb-2">
             <a href="/user/<%=currUserId%>/myPlaylists"  class='text-center my-auto'>My Playlists</a>
        </div>
        <div class="col-3 d-flex justify-content-center tabDiv pb-2">
             <a href="/user/<%=currUserId%>/favouriteEpisodes" class='text-dark text-center my-auto'>All Favourite Episodes</a>
        </div>
        <div class="col-3 d-flex justify-content-center pb-2">
             <a href="/user/<%=currUserId%>/favouriteComments" class='text-center my-auto'>All Favourite Comments</a>
        </div>
        <div class="col-3 d-flex justify-content-center pb-2">
             <a href="/user/<%=currUserId%>/following" class='text-center my-auto'>Following</a>
        </div>
    </div>  
 </div>

<!-- Display All Favourite Episodes -->
<div class="container profilePageDisplay smallTable">
     <table class="table table-hover" class="collapse" data-parent="#overallAccordion">
  <thead>
    <tr>      
      <th scope="col" class='text-dark text-center smallHeader border-0'><div></div></th>
      <th scope="col" class='text-dark text-center smallHeader border-0'>Episode</th>
      <th scope="col" class='text-dark text-center smallHeader border-0'>Ep. No.</th>
    </tr>
  </thead>
  <tbody id="accordion">
    <tr class= "accordion-toggle collapsed" data-toggle="collapse" data-target="#collapse1">
      <% episodes.forEach((episode)=>{ %>
      <td class='text-center d-flex flex-row justify-content-center'>
        <form class="epArtworkDisplay playlistArtworkContainer"action ='/user/<%=currUserId%>/favouriteEpisodes'>
        <img class='w-100 h-auto' src="/<%=episode.artwork_filename%>"/>                
          <button class="rounded-circle" type='submit'><i class='fa fa-play ml-2'></i></button>          
        <input type='hidden' name="podcast_ext_url" value="<%=episode.podcast_ext_url%>"/>
      </form>
    </td>
      <td class='text-center'><a class="text-dark" href='/series/<%=episode.podcast_series_id%>/episode/<%=episode.podcast_episode_id%>'><%=episode.name%></a></form></td>
      <td class='text-dark text-center'><%= episode.episode_number %></td>        
    <td class='actionBtns border-0'>
            
                <% if(isUserAuth === true){ %>
              <form action='/user/<%=loggedInUserId%>/editFavouriteEpisode/<%=episode.podcast_episode_id%>?_method=PUT' method="POST">
                <button class="favouriteBtn bg-transparent border-0 shadow-none"                             
                type="submit"
                >                  
                    <% if(episode.favourited === true ){ %>
                    <i class="fa fa-heart"></i>
                    <% } else if(episode.favourited === false) { %>
                    <i class="fa fa-heart-o"></i>
                    <% } %>
                </button>              
                <input type="hidden" name="favouriteSeries"/>                              
              </form>
            <% } %>
            
        </form>
      </div>
    </td>
    </tr>
    <% }); %>   
  </tbody>
</table>
</div>
</div>
</body>

<div class="spacing"></div>
<span class="iframeDisplay">
    <iframe class ="mt-2 " width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay" src='<%=episodeLinkToPlay%>'></iframe>
</span>
<%-include('../mainpage/footer') %>
